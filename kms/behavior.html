<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet href=styles.css><script defer src=db.js></script>
<script defer>
document.addEventListener('DOMContentLoaded', async ()=>{
  await kmsOpenDB(); const workers = await kmsGetAll('workers');
  document.getElementById('worker').innerHTML = workers.map(w=>`<option value="${w.worker_id}">${w.full_name}</option>`).join('');
  const form=document.getElementById('behForm');
  form.addEventListener('submit', async e=>{
    e.preventDefault(); const f=form;
    await kmsAdd('behavior_entries',{worker_id:Number(f.worker.value), observed_at:f.observed_at.value||new Date().toISOString(), category:f.category.value, rating:Number(f.rating.value), notes:f.notes.value||null});
    f.reset(); render();
  });
  async function render(){ const rows=await kmsGetAll('behavior_entries'); const tbody=document.querySelector('#list tbody'); tbody.innerHTML='';
    for(const r of rows.sort((a,b)=> (b.observed_at||'').localeCompare(a.observed_at||''))){ const tr=document.createElement('tr'); tr.innerHTML = `<td>${(r.observed_at||'').slice(0,16).replace('T',' ')}</td><td>${r.worker_id}</td><td>${r.category}</td><td>${'â˜…'.repeat(r.rating||0)}</td><td>${r.notes||''}</td>`; tbody.appendChild(tr); } }
  render();
});
</script>
<title>Behavior</title></head><body>
<div class=container>
  <h1>Behavioral Insights</h1>
  <div class=card>
    <form id=behForm>
      <label>Worker</label><select id=worker name=worker required></select>
      <label>Observed at</label><input type=datetime-local id=observed_at name=observed_at>
      <label>Category</label><select id=category name=category><option>Punctuality</option><option>Teamwork</option><option>Focus</option><option>Cleanliness</option><option>Initiative</option><option>Communication</option></select>
      <label>Rating (1-5)</label><input type=number id=rating name=rating min=1 max=5 value=4>
      <label>Notes</label><input id=notes name=notes>
      <button type=submit>Save</button>
    </form>
  </div>
  <div class=card>
    <table class=table id=list><thead><tr><th>When</th><th>Worker</th><th>Category</th><th>Rating</th><th>Notes</th></tr></thead><tbody></tbody></table>
  </div>
</div>
<nav class=bottom>
  <a href=index.html>ğŸ </a><a href=init.html>âš™ï¸</a><a href=log.html>ğŸ“</a><a href=reports.html>ğŸ“Š</a><a class=active href=behavior.html>â­</a><a href=edit.html>âœï¸</a>
</nav><div style="height:72px"></div>
</body></html>